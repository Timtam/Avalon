<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, September 05, 2010, 1:33 PM -->
<!-- MuClient version 4.60 -->

<!-- Plugin "lua_jfw" generated by Plugin Wizard -->

<muclient>
<plugin
   name="lua_jfw"
   author="Oriol Gomez"
   id="a4b85011eae6a94f4ed31358"
   language="Lua"
   purpose="speak incoming text using jaws."
   save_state="y"
   date_written="2010-09-05 13:32:41"
   requires="4.60"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>
<!--  Aliases  -->

<aliases>
  <alias
   match="tts_stop"
   enabled="y"
   send_to="12"
   sequence="100"
  >
<send>tts:StopSpeech()</send>
  </alias>
  <alias
   match="tts_interrupt *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>tts:stopspeech()
tts:sayString("%1",1)</send>
  </alias>
  <alias
   match="tts_note *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>tts:sayString("%1",0)</send>
  </alias>
  <alias
   script="TTSToggle"
   match="tts"
   enabled="y"
   group="TTS"
   omit_from_command_history="y"
   omit_from_log="y"
   omit_from_output="y"
   sequence="100"
  >
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[
read=1
function TTSToggle(name,line,x)
if read==1 then
read=0
tts:saystring("Incoming text will not be read.",1)
else
read=1
tts:saystring("Incoming text will be read.",1)
end--if
end--func
function OnPluginScreendraw(t,log,line)
if (t == 0 or t == 1)  and read == 1 then
tts:saystring(line,0)
end--if
end--func
function OnPluginBroadcast (msg, id, name, text)
if (msg == 887 or msg == 8874) then
tts:saystring(text,0)
end--if
end--func
function OnPluginTabComplete(s)
tts:saystring(s,1)
end
function OnPluginInstall()
  -- load Lua COM
  require "luacom"
  
  -- Instantiate a SAPI voice obejct
tts= assert (luacom.CreateObject ("jfwapi"), "cannot open SAPI")
tts:sayString("Speech PlugIn for jaws ready.",1)
read=1

end
]]>
</script>


</muclient>
