<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE muclient>
<!-- Saved on Wednesday, August 28, 2002, 10:48 AM -->
<!-- MuClient version 3.26 -->

<!-- Plugin "Multiple_Send" generated by Plugin Wizard -->

<!--
See forum post 

http://www.gammon.com.au/forum/bbshowpost.php?bbsubject_id=1403

for more details about this script.
-->

<muclient>
<plugin
   name="Multiple_Send"
   author="Nick Gammon"
   id="33e3ed2a4a9751329b048b5c"
   language="VBscript"
   purpose="Sends commands to multiple worlds"
   date_written="2002-08-28 10:44:11"
   date_modified="2003-04-21 08:37:30"
   requires="3.39"
   version="1.1"
   >
<!--
Version 1 - initial release.
Version 1.1 - changed to use WorldGetIDList so it would still work
              if you had multiple worlds of the same name.
-->
<description trim="y">
<![CDATA[
You can send a command to one or more worlds, or all worlds, like this:

#all say Goodnight All  <-- sends to all open worlds
#1   say Hi everyone    <-- sends to world #1
#123 say Follow Me      <-- sends to worlds #1, #2 and #3

Multiple_Send:help      <-- this help screen


]]>
</description>

</plugin>


<!--  Aliases  -->

<aliases>
  <alias
   script="SendToWlds"
   match="#* *"
   enabled="y"
  >
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[
'
'  based on a script by Shadowfyr (with minor corrections)
'

sub SendToWlds(name, output, wildcards)
 dim z, wrld

 select case wildcards(1)
   case "all"
     for each wrld in world.getworldIDlist
       set sndworld = world.getworldbyid(wrld)
       sndworld.send wildcards(2)
     next
   case else
     if isnumeric(wildcards(1)) then
       count = 1
       for each wrld in world.getworldIDlist
         if instr (wildcards (1), cstr (count)) and count < 10 then
           set sndworld = world.getworldbyid(wrld)
           sndworld.send wildcards(2)
         end if
         count = count + 1
       next
     else
       world.note "Error! Unable to determine world to send to."
     end if
 end select
end sub


]]>
</script>


<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="Multiple_Send:help"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
Sub OnHelp (sName, sLine, wildcards)
  World.Note World.GetPluginInfo (World.GetPluginID, 3)
End Sub
]]>
</script> 

</muclient>
